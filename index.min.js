"use strict";var HistoryOfPhilanthropy=function(){function o(){h(),r()}function t(o){function t(){if(!(g=v("#history-of-philanthropy")).length)return s(new Error("Did not find #history-of-philanthropy container."));c(m+"style.css"),c(m+"typography.css"),u(g,m+"container.html").then(function(){return y=v("#timeline-entries"),d(),f()}).then(function(){v(window).trigger("resize"),setTimeout(function(){a(C[0])},200)}).catch(function(){s(new Error("Error loading html."))})}return k?s(new Error("History of Philanthropy already initialized.")):(o=o||{},(v=o.jQuery||("undefined"!=typeof jQuery?jQuery:null))?(o.env=o.env||"prod",function(){var t=void 0;t=o.env,t=p[t]?t:"prod",m=p[t].path,w=p[t].imagePath}(),k=!0,void v(t)):s(new Error("jQuery is a required dependency.")))}function n(){var o=v("body"),t=void 0;(t=v("#hop-lightbox-overlay")).length||(t=v('<div id="hop-lightbox-overlay"></div>'),o.append(t)),o.addClass("active-overlay"),g.before('<div id="history-of-philanthropy-placeholder"></div>'),g.detach().appendTo(t),v("#lightbox-toggle").removeClass("pop-out").addClass("pop-in")}function e(){var o=v("body"),t=v("#history-of-philanthropy-placeholder");g.detach().insertAfter(t),t.remove(),o.removeClass("active-overlay"),v("#lightbox-toggle").removeClass("pop-in").addClass("pop-out")}function i(){v("body").hasClass("active-overlay")?e():n(),r()}function r(){a(b)}function a(o){var t=v("#"+o);if(t.length){b=o,y.stop();var n=C.indexOf(o),e=t.position(),i=Math.floor(e.top+y.scrollTop()),r=function(o){var t=Math.E;return o=Math.abs(o),500/(1+Math.pow(t,-.01*(o-300)))}(i-y.scrollTop());n===C.length-1?v("#scroll-down").addClass("disabled"):v("#scroll-down").removeClass("disabled"),0===n?v("#scroll-up").addClass("disabled"):v("#scroll-up").removeClass("disabled"),y.animate({scrollTop:i},r)}else s(new Error("Cannot scroll to invalid timeline entry."))}function l(o){var t=void 0;if(o=o||"forward",!(C<=1)){b||(b=C[0]);var n=C.indexOf(b);"forward"===o&&n<C.length-1?t=C[n+1]:"backward"===o&&n>0&&(t=C[n-1]),t&&a(t)}}function d(){v(window).on("resize",function(){M&&clearTimeout(M),M=setTimeout(function(){o(),clearTimeout(M),M=null},100)}).trigger("resize"),v("#lightbox-toggle").on("click",function(o){o.preventDefault(),i()}),v("#scroll-down").on("click",function(o){o.preventDefault(),l("forward")}),v("#scroll-up").not(".disabled").on("click",function(o){o.preventDefault(),l("backward")})}function h(){var o=v(window).width(),t=v(window).height(),n=g.outerWidth(),e=g.outerHeight();if(function(){x=Math.floor(n/e*10)/10}(),e<t)g.css("width","");else{var i=Math.max(480,Math.floor(t*x));g.css("width",Math.min(o,i)+"px")}}function s(o){T.push(o.message)}function c(o){v("<link>").attr("href",o).attr("rel","stylesheet").appendTo("head")}function u(o,t,n){return o="string"==typeof o?v(o):o,new Promise(function(e,i){if(!o.length)return i(new Error("Could not find thing."));v.get(t,{},function(t){if("function"==typeof n){var i=document.createElement("div");i.innerHTML=t,n(v(i)),o.html(i.innerHTML)}else o.html(t);e()})})}function f(){function o(o){o.children("li").each(function(o,t){var n=void 0;n=(n=v(t).css("background-image")).replace(/(http.*?)?images\//g,w),v(t).css("background-image",n)})}return new Promise(function(t,n){u(y,m+"timeline-gw.html",o).then(function(){C=[],y.children("li").each(function(o,t){C.push(v(t).attr("id"))}),b=C[0],t()}).catch(n)})}var p={prod:{path:"http://gwalumni.org/projects/history-of-philanthropy/",imagePath:"http://gwalumni.org/projects/history-of-philanthropy/images/"},dev:{path:"https://growlfrequency.com/work/gw-history-of-philanthropy/",imagePath:"https://growlfrequency.com/work/gw-history-of-philanthropy/images/"}},v=void 0,g=void 0,y=void 0,m=void 0,w=void 0,b=void 0,C=[],T=[],k=void 0,M=void 0,x=void 0;return{init:t}}();